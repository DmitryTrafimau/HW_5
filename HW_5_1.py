PRODUCTS = [
    {'name': 'Sour cream', 'price': 2.5, 'shop': 'Producty', 'vendor': 'Slabkin'},
    {'name': 'Cheese', 'price': 2.5, 'shop': 'Producty', 'vendor': 'Baba Anya'},
    {'name': 'Cheese', 'price': 1.6, 'shop': '5ka', 'vendor': 'Slabkin'},
    {'name': 'Kefir', 'price': 1.5, 'shop': 'AsiaOpt', 'vendor': 'G&M'},
    {'name': 'Sour cream', 'price': 1.9, 'shop': 'Silpo', 'vendor': 'Lidskoe'},
    {'name': 'Kefir', 'price': 1.6, 'shop': 'Producty', 'vendor': 'G&M'},
    {'name': 'Cheese', 'price': 1.7, 'shop': 'AsiaOpt', 'vendor': 'G&M'},
    {'name': 'Milk', 'price': 2.3, 'shop': 'AsiaOpt', 'vendor': 'Lidskoe'},
    {'name': 'Kefir', 'price': 1.5, 'shop': '5ka', 'vendor': 'Slabkin'},
    {'name': 'Kefir', 'price': 1.7, 'shop': 'Producty', 'vendor': 'Slabkin'},
    {'name': 'Milk', 'price': 2.2, 'shop': '5ka', 'vendor': 'Lidskoe'},
    {'name': 'Milk', 'price': 1.9, 'shop': 'Producty', 'vendor': 'Baba Anya'},
    {'name': 'Cream', 'price': 2.5, 'shop': 'Producty', 'vendor': 'G&M'},
    {'name': 'Cream', 'price': 2.2, 'shop': 'Silpo', 'vendor': 'G&M'},
    {'name': 'Sour cream', 'price': 1.8, 'shop': 'AsiaOpt', 'vendor': 'G&M'},
    {'name': 'Cheese', 'price': 2.3, 'shop': 'Silpo', 'vendor': 'Baba Anya'},
    {'name': 'Cheese', 'price': 2.0, 'shop': '5ka', 'vendor': 'G&M'},
    {'name': 'Cream', 'price': 1.9, 'shop': 'Producty', 'vendor': 'Lidskoe'},
    {'name': 'Sour cream', 'price': 2.2, 'shop': '5ka', 'vendor': 'Lidskoe'},
    {'name': 'Cheese', 'price': 2.5, 'shop': 'Producty', 'vendor': 'G&M'},
    {'name': 'Kefir', 'price': 2.0, 'shop': 'Silpo', 'vendor': 'Baba Anya'},
    {'name': 'Sour cream', 'price': 2.4, 'shop': '5ka', 'vendor': 'Slabkin'},
    {'name': 'Kefir', 'price': 1.7, 'shop': 'Silpo', 'vendor': 'G&M'},
    {'name': 'Sour cream', 'price': 1.7, 'shop': '5ka', 'vendor': 'Baba Anya'},
    {'name': 'Cheese', 'price': 1.9, 'shop': 'Producty', 'vendor': 'Slabkin'},
    {'name': 'Sour cream', 'price': 1.6, 'shop': 'Silpo', 'vendor': 'Baba Anya'},
    {'name': 'Milk', 'price': 2.3, 'shop': 'Silpo', 'vendor': 'Baba Anya'},
    {'name': 'Cream', 'price': 2.4, 'shop': 'Silpo', 'vendor': 'Slabkin'},
    {'name': 'Cream', 'price': 2.3, 'shop': 'AsiaOpt', 'vendor': 'Slabkin'},
    {'name': 'Kefir', 'price': 1.7, 'shop': 'AsiaOpt', 'vendor': 'Slabkin'},
    {'name': 'Kefir', 'price': 2.5, 'shop': 'Producty', 'vendor': 'Baba Anya'},
    {'name': 'Cream', 'price': 1.7, 'shop': 'Producty', 'vendor': 'Baba Anya'},
    {'name': 'Milk', 'price': 1.7, 'shop': '5ka', 'vendor': 'Baba Anya'},
    {'name': 'Cream', 'price': 1.9, 'shop': '5ka', 'vendor': 'G&M'},
    {'name': 'Cheese', 'price': 2.5, 'shop': 'Silpo', 'vendor': 'G&M'},
    {'name': 'Kefir', 'price': 1.7, 'shop': 'Silpo', 'vendor': 'Slabkin'},
    {'name': 'Cream', 'price': 2.0, 'shop': 'Producty', 'vendor': 'Slabkin'},
    {'name': 'Kefir', 'price': 2.4, 'shop': '5ka', 'vendor': 'G&M'},
    {'name': 'Milk', 'price': 2.0, 'shop': 'Producty', 'vendor': 'G&M'},
    {'name': 'Sour cream', 'price': 2.1, 'shop': 'AsiaOpt', 'vendor': 'Baba Anya'},
    {'name': 'Kefir', 'price': 1.8, 'shop': 'Silpo', 'vendor': 'Lidskoe'},
    {'name': 'Cheese', 'price': 2.3, 'shop': 'Producty', 'vendor': 'Lidskoe'},
    {'name': 'Milk', 'price': 1.6, 'shop': 'Silpo', 'vendor': 'Lidskoe'},
    {'name': 'Milk', 'price': 2.3, 'shop': 'Silpo', 'vendor': 'G&M'},
    {'name': 'Cream', 'price': 1.8, 'shop': 'Silpo', 'vendor': 'Baba Anya'},
    {'name': 'Milk', 'price': 1.7, 'shop': 'Producty', 'vendor': 'Slabkin'},
    {'name': 'Cream', 'price': 2.4, 'shop': '5ka', 'vendor': 'Baba Anya'},
    {'name': 'Sour cream', 'price': 1.7, 'shop': 'Producty', 'vendor': 'Lidskoe'},
    {'name': 'Cheese', 'price': 2.2, 'shop': 'AsiaOpt', 'vendor': 'Baba Anya'},
    {'name': 'Milk', 'price': 2.1, 'shop': 'Silpo', 'vendor': 'Slabkin'},
    {'name': 'Milk', 'price': 1.9, 'shop': 'AsiaOpt', 'vendor': 'Baba Anya'},
    {'name': 'Cheese', 'price': 2.4, 'shop': '5ka', 'vendor': 'Lidskoe'},
    {'name': 'Kefir', 'price': 1.8, 'shop': 'Producty', 'vendor': 'Lidskoe'},
    {'name': 'Milk', 'price': 1.5, 'shop': '5ka', 'vendor': 'G&M'},
    {'name': 'Kefir', 'price': 2.4, 'shop': 'AsiaOpt', 'vendor': 'Baba Anya'},
    {'name': 'Cheese', 'price': 2.4, 'shop': 'AsiaOpt', 'vendor': 'Lidskoe'},
    {'name': 'Sour cream', 'price': 1.5, 'shop': 'Silpo', 'vendor': 'Slabkin'},
    {'name': 'Cream', 'price': 2.5, 'shop': 'AsiaOpt', 'vendor': 'Lidskoe'},
    {'name': 'Kefir', 'price': 2.3, 'shop': '5ka', 'vendor': 'Lidskoe'},
    {'name': 'Cream', 'price': 1.7, 'shop': 'AsiaOpt', 'vendor': 'G&M'},
    {'name': 'Cheese', 'price': 1.8, 'shop': 'Silpo', 'vendor': 'Slabkin'},
]


def name_sort(x):
    if x.get('name') == s_product:
        return True
    else:
        return False


def vendor_sort(y):
    if y.get('vendor') == w_product:
        return True
    else:
        return False


def wish_check_in_stock(t):
    result = 0
    if len(t) == len(wish_list_split):
        lis = []
        for h in t:
            result += h.get('price')
            d = {h.get('name'): h.get('price'), 'prodavan': h.get('vendor')}
            lis.append(d)
        lis = tuple(lis)
        s = {'final price': round(result, 1), 'shop': h.get('shop'), 'havka': lis}
        final_list.append(s)
        return s


wish_list = input('Введите список продуктов через запятую ')
if not wish_list:
    print('Вы не ввели ни одного наименования продуктов.')
else:
    wish_list_split = wish_list.split(',')
    brand_list = input('Введите пожелания по бредам ')
    brand_list_split = brand_list.split(',')

    pyaterka = []
    asia_opt = []
    silpo = []
    producty = []

    for s_product in wish_list_split:
        for w_product in brand_list_split:
            s = filter(name_sort, PRODUCTS)
            if brand_list:
                d = list(filter(vendor_sort, s))
            else:
                d = s
            for j in d:
                if j.get('shop') == '5ka':
                    pyaterka.append(j)
                    pyaterka.sort(key=lambda x: (x['price']))
                elif j.get('shop') == 'AsiaOpt':
                    asia_opt.append(j)
                    asia_opt.sort(key=lambda x: (x['price']))
                elif j.get('shop') == 'Silpo':
                    silpo.append(j)
                    silpo.sort(key=lambda x: (x['price']))
                elif j.get('shop') == 'Producty':
                    producty.append(j)
                    producty.sort(key=lambda x: (x['price']))


    pyaterka_final_list = []
    asia_opt_final_list = []
    silpo_final_list = []
    producty_final_list = []
    final_list = []

    for s_product in wish_list_split:
        p = (list(filter(name_sort, pyaterka)))
        if len(p) > 0:
            pyaterka_final_list.append(p[0])
        a = (list(filter(name_sort, asia_opt)))
        if len(a) > 0:
            asia_opt_final_list.append(a[0])
        s = (list(filter(name_sort, silpo)))
        if len(s) > 0:
            silpo_final_list.append(s[0])
        pr = (list(filter(name_sort, producty)))
        if len(pr) > 0:
            producty_final_list.append(pr[0])

    wish_check_in_stock(pyaterka_final_list)
    wish_check_in_stock(asia_opt_final_list)
    wish_check_in_stock(silpo_final_list)
    wish_check_in_stock(producty_final_list)

    if len(final_list) == 0:
        print('Извините, такие продукты в одном магазине купить не получится. '
              'Измените количество брендов или количество продуктов.')
    else:
        final_list.sort(key=lambda x: (x['final price']))
        print('final list - ', final_list)
        print('Рекомендуем пойти в', final_list[0].get('shop'))
        print('Там вы купите:')
        for s_product in wish_list_split:
            for s in (list(final_list[0].get('havka'))):
                if s.get(s_product) != None:
                    print(s_product, 'по', s.get(s_product), '(', s.get('prodavan'), ')')
        print('Сумма к оплате будет - ', final_list[0].get('final price'))
